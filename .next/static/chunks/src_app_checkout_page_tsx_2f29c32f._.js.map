{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/awis/Downloads/%D9%81%D9%82%D8%B7%20%D9%84%D8%AA%D8%AC%D8%B1%D8%A8%D8%A9%20%D8%A7%D9%84%D8%AF%D9%81%D8%B9%20%D9%88%D8%A8%D8%B9%D8%AF%D9%87%D8%A7%20%D9%84%D9%84%D9%85%D8%B3%D8%ADs/seller-frontend/src/app/checkout/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState, useRef } from \"react\";\nimport { useCart } from \"@/components/CartContext\";\nimport { useRouter } from \"next/navigation\";\nimport { formatPrice, getConfig, getOrCreateGuestId, getShippingMethods, getSellerInfoFromCart, placeOrder, addAddress, getAddressList, chooseShippingMethod, getCart, digitalPaymentPlaceOrder, setCheckoutSession } from \"@/utils/api\";\nimport Link from \"next/link\";\nimport { useLanguage } from '../../context/LanguageContext';\nimport { WEB_CONSTANTS } from '../web_constantsthe';\nimport i18n from '../../i18n';\n\n// Helper: Retry fetching address list after address creation\nasync function fetchLatestAddressWithRetry(guestId: string, retries = 5, delayMs = 300): Promise<number | null> {\n  for (let i = 0; i < retries; i++) {\n    const addressList = await getAddressList(guestId);\n    if (Array.isArray(addressList) && addressList.length > 0) {\n      const sorted = [...addressList].sort((a, b) => (b.id || 0) - (a.id || 0));\n      const foundId = sorted[0].id || sorted[0].address_id;\n      return foundId;\n    }\n    await new Promise(res => setTimeout(res, delayMs));\n  }\n  return null;\n}\n\nfunction isDefined<T>(val: T | undefined | null): val is T {\n  return val !== undefined && val !== null;\n}\n\ntype WebPaymentRequestParams = {\n  user_id: string | number;\n  customer_id: string | number;\n  payment_method: string;\n  payment_platform: string;\n  callback?: string;\n  address_id?: string | number;\n  billing_address_id?: string | number;\n  order_note?: string;\n};\n\n// Helper to fetch CSRF token from backend\nasync function fetchCsrfToken(): Promise<string | null> {\n  try {\n    const res = await fetch('https://awisapp.com/customer/web-payment-request', {\n      method: 'GET',\n      credentials: 'include',\n    });\n    const html = await res.text();\n    // Try to find meta tag first\n    const metaMatch = html.match(/<meta name=\"csrf-token\" content=\"([^\"]+)\"/);\n    if (metaMatch && metaMatch[1]) return metaMatch[1];\n    // Fallback: try to find hidden input\n    const inputMatch = html.match(/<input[^>]+name=['\\\"]?_token['\\\"]?[^>]+value=['\\\"]?([^'\\\"> ]+)['\\\"]?[^>]*>/);\n    if (inputMatch && inputMatch[1]) return inputMatch[1];\n    return null;\n  } catch {\n    return null;\n  }\n}\n\nfunction submitWebPaymentRequest({\n  user_id,\n  customer_id,\n  payment_method,\n  payment_platform,\n  callback,\n  address_id,\n  billing_address_id,\n  order_note,\n  csrf_token,\n}: WebPaymentRequestParams & { csrf_token: string }) {\n  const form = document.createElement('form');\n  form.method = 'POST';\n  form.action = 'https://awisapp.com/customer/web-payment-request';\n  form.target = '_self';\n  const fields: [string, string | number | undefined | null][] = [\n    ['_token', csrf_token],\n    ['user_id', user_id],\n    ['customer_id', customer_id],\n    ['payment_method', payment_method],\n    ['payment_platform', payment_platform],\n    ['callback', callback],\n    ['address_id', address_id],\n    ['billing_address_id', billing_address_id],\n    ['order_note', order_note],\n  ];\n  fields.forEach(([name, value]) => {\n    if (isDefined(value)) {\n      const input = document.createElement('input');\n      input.type = 'hidden';\n      input.name = name;\n      input.value = String(value);\n      form.appendChild(input);\n    }\n  });\n  document.body.appendChild(form);\n  form.submit();\n}\n\nfunction getLocalizedProductName(item: any, language: string) {\n  const product = item.product || {};\n  if (product.translations && Array.isArray(product.translations)) {\n    if (language === 'ar') {\n      const t = product.translations.find((tr: any) => (tr.locale === 'kw' || tr.locale === 'ar') && tr.key === 'name');\n      if (t && t.value) return t.value;\n    } else {\n      const t = product.translations.find((tr: any) => tr.locale === 'en' && tr.key === 'name');\n      if (t && t.value) return t.value;\n    }\n  }\n  // Fallbacks\n  if (language === 'ar') return product.name_ar || product.name || item.name;\n  return product.name || item.name;\n}\n\nexport default function CheckoutPage() {\n  const { state, clearCart } = useCart();\n  const router = useRouter();\n  const { language } = useLanguage();\n  const [step, setStep] = useState(1);\n  const [form, setForm] = useState({\n    name: \"\",\n    phone: \"\",\n    email: \"\",\n    country: \"Kuwait\",\n    city: \"\",\n    postal: \"\",\n    address: \"\",\n    addressType: \"دائم\",\n  });\n  const [delivery, setDelivery] = useState<string>(\"\");\n  const [deliveryPrice, setDeliveryPrice] = useState<number>(0);\n  const [shippingOptions, setShippingOptions] = useState<any[]>([]);\n  const [shippingLoading, setShippingLoading] = useState(false);\n  const [payment, setPayment] = useState<string>(\"\");\n  const [placing, setPlacing] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState<string | null>(null);\n  const [config, setConfig] = useState<any>(null);\n  const [paymentMethods, setPaymentMethods] = useState<any[]>([]);\n  const [paymentMethodsLoading, setPaymentMethodsLoading] = useState(true);\n  const [paymentMethodsError, setPaymentMethodsError] = useState<string | null>(null);\n  const [guestId, setGuestId] = useState<string | null>(null);\n  const [guestIdLoading, setGuestIdLoading] = useState(true);\n  const [guestIdError, setGuestIdError] = useState<string | null>(null);\n  const [addressId, setAddressId] = useState<number | null>(null);\n  const [addressLoading, setAddressLoading] = useState(false);\n  const [allowedCountries, setAllowedCountries] = useState<string[]>([]);\n  const [allowedCountriesLoading, setAllowedCountriesLoading] = useState(true);\n  const [countryError, setCountryError] = useState<string | null>(null);\n  const [pendingRedirect, setPendingRedirect] = useState<string | null>(null);\n  \n  // Add mounted state tracking\n  const isMounted = useRef(true);\n\n  useEffect(() => {\n    // Component is mounted\n    isMounted.current = true;\n    \n    // Cleanup function to mark as unmounted\n    return () => {\n      isMounted.current = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    getConfig()\n      .then((cfg) => {\n        setConfig(cfg);\n      })\n      .catch(() => setConfig(null));\n  }, []);\n\n  useEffect(() => {\n    getOrCreateGuestId()\n      .then((id) => {\n        setGuestId(id);\n        setGuestIdLoading(false);\n      })\n      .catch(() => {\n        setGuestIdError(\"تعذر الحصول على رقم الضيف. يرجى إعادة تحميل الصفحة.\");\n        setGuestIdLoading(false);\n      });\n  }, []);\n\n  // Only fetch shipping methods after guestId is ready\n  useEffect(() => {\n    if (!guestIdLoading && guestId) {\n      // Flutter app logic: Try seller's shipping methods first, then fallback to admin/global if none found\n      const { sellerId, sellerType } = getSellerInfoFromCart(state.items);\n      setShippingLoading(true);\n      getShippingMethods(sellerId, sellerType, guestId)\n        .then((options) => {\n          setShippingOptions(options);\n          if (options.length > 0) {\n            setDelivery(options[0].key || options[0].id || options[0].title);\n            setDeliveryPrice(Number(options[0].cost || 0));\n          }\n        })\n        .catch((err) => {\n          setShippingOptions([]);\n        })\n        .finally(() => setShippingLoading(false));\n    }\n  }, [guestIdLoading, guestId, state.items]);\n\n  // Fetch allowed delivery countries on mount\n  useEffect(() => {\n    if (!guestId) return;\n    setAllowedCountriesLoading(true);\n    fetch(`https://awisapp.com/api/v1/customer/get-restricted-country-list?guest_id=${guestId}`)\n      .then(async res => {\n        if (!res.ok) {\n          let msg = 'تعذر تحميل قائمة الدول. يرجى إعادة المحاولة لاحقاً.';\n          if (res.status === 401) msg = 'غير مصرح. يرجى إعادة تحميل الصفحة أو تسجيل الدخول.';\n          setAllowedCountries([]);\n          setCountryError(msg);\n          setAllowedCountriesLoading(false);\n          return;\n        }\n        const data = await res.json();\n        if (Array.isArray(data) && data.length > 0 && data.every(c => typeof c === 'string')) {\n          setAllowedCountries(data);\n          setCountryError(null);\n        } else {\n          setAllowedCountries([]);\n          setCountryError('تعذر تحميل قائمة الدول. يرجى إعادة المحاولة لاحقاً.');\n        }\n        setAllowedCountriesLoading(false);\n      })\n      .catch(() => {\n        setAllowedCountries([]);\n        setCountryError('تعذر تحميل قائمة الدول. يرجى التحقق من الاتصال أو المحاولة لاحقاً.');\n        setAllowedCountriesLoading(false);\n      });\n  }, [guestId]);\n\n  // Fetch payment methods from backend config\n  useEffect(() => {\n    async function fetchPaymentMethods() {\n      setPaymentMethodsLoading(true);\n      setPaymentMethodsError(null);\n      try {\n        const res = await fetch(\"https://awisapp.com/api/v1/config\", {\n          headers: {\n            'Content-Type': 'application/json',\n            'Accept-Language': language,\n            'X-Language': language,\n          },\n        });\n        if (!res.ok) throw new Error(\"فشل تحميل طرق الدفع من الخادم\");\n        const data = await res.json();\n        // Use all payment methods returned by the backend (do not filter by is_active)\n        const allMethods = data.payment_methods || [];\n        setPaymentMethods(allMethods);\n        if ((!payment || payment === '') && allMethods.length > 0) {\n          setPayment(allMethods[0].key || allMethods[0].key_name || '');\n        }\n      } catch (err: any) {\n        setPaymentMethodsError(err.message || \"فشل تحميل طرق الدفع\");\n      } finally {\n        setPaymentMethodsLoading(false);\n      }\n    }\n    fetchPaymentMethods();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // Synchronous effect to perform redirect\n  useEffect(() => {\n    if (pendingRedirect && isMounted.current) {\n      window.location.href = pendingRedirect;\n    }\n  }, [pendingRedirect]);\n\n  // Redirect to cart if cart is empty\n  useEffect(() => {\n    if (state.items.length === 0) {\n      router.replace('/cart');\n    }\n  }, [state.items, router]);\n\n  // Step validation\n  const validateStep = () => {\n    if (step === 1) {\n      const required = [\"name\", \"phone\", \"email\", \"country\", \"city\", \"postal\", \"address\"];\n      return required.every((k) => form[k as keyof typeof form].trim() !== \"\");\n    }\n    if (step === 2) {\n      return !!delivery;\n    }\n    if (step === 3) {\n      return !!payment;\n    }\n    return true;\n  };\n\n  // Address creation (step 1)\n  const handleAddressNext = async () => {\n    setError(null);\n    // No address API call, just validate and move to next step\n    try {\n      if (!validateStep()) throw new Error(\"يرجى تعبئة جميع الحقون المطلوبة\");\n      setStep(2);\n    } catch (err: any) {\n      setError(err.message || \"حدث خطأ أثناء إضافة العنوان\");\n    }\n  };\n\n  // Place order (final step)\n  const handlePayment = async () => {\n    try {\n      if (!isMounted.current) return;\n      setPlacing(true);\n      setError(null);\n      setSuccess(null);\n      if (!delivery) throw new Error(\"يرجى اختيار طريقة التوصيل\");\n      if (!payment) throw new Error(\"يرجى اختيار طريقة الدفع\");\n      if (!state.items.length) throw new Error(\"السلة فارغة\");\n      if (guestIdLoading || !guestId) throw new Error('يرجى الانتظار حتى يتم تجهيز الحساب المؤقت');\n      // 1. Create address and get address_id\n      const addressRes = await addAddress({\n        name: form.name,\n        phone: form.phone,\n        email: form.email,\n        country: form.country,\n        city: form.city,\n        postal: form.postal,\n        address: form.address,\n        address_type: form.addressType,\n        guest_id: guestId,\n      });\n      let address_id = addressRes.address_id || addressRes.id || addressRes.data?.id;\n      if (!address_id) {\n        address_id = await fetchLatestAddressWithRetry(guestId);\n      }\n      if (!address_id) throw new Error(\"فشل حفظ العنوان. يرجى المحاولة مرة أخرى.\");\n      // 2. Fetch cart and select shipping method\n      const cart = await getCart();\n      if (!Array.isArray(cart) || cart.length === 0) {\n        if (isMounted.current) {\n          setError('السلة فارغة أو لم يتم مزامنتها مع الخادم بعد. يرجى إضافة منتجات وإعادة المحاولة.');\n          setPlacing(false);\n        }\n        return;\n      }\n      let cartGroupId = 'default';\n      if (cart[0].cart_group_id) {\n        cartGroupId = cart[0].cart_group_id;\n      }\n      await chooseShippingMethod(delivery, guestId, cartGroupId);\n      // 3. Place order with address_id and shipping_cost\n      if (payment !== 'cod') {\n        // Digital/online payment flow: send all order data to backend, get redirect_link\n        const payload = {\n          order_note: '',\n          customer_id: guestId,\n          address_id,\n          billing_address_id: address_id,\n          coupon_code: '',\n          coupon_discount: '',\n          payment_method: payment,\n          is_check_create_account: false,\n          password: '',\n          payment_platform: 'web',\n          payment_request_from: 'app',\n          guest_id: guestId,\n          is_guest: true,\n          external_redirect_link: 'https://awisapp.com/web-payment?flag=success&&token={token}',\n        };\n\n        const res = await fetch('https://awisapp.com/api/v1/digital-payment', {\n          method: 'POST',\n          headers: { \n            'Content-Type': 'application/json',\n            'Accept-Language': language,\n            'X-Language': language,\n          },\n          body: JSON.stringify(payload),\n          credentials: 'include', // Include cookies if available\n        });\n        \n        if (!res.ok) {\n          const errorText = await res.text();\n          throw new Error(`Backend error: ${res.status} ${res.statusText}`);\n        }\n        \n        // Check if response is a redirect (should not happen with JSON API)\n        if (res.redirected) {\n          // If backend redirected to payment gateway, navigate there\n          if (isMounted.current) {\n            // Set session storage flag to indicate payment attempt\n            if (typeof window !== 'undefined') {\n              sessionStorage.setItem('recent_payment_attempt', 'true');\n            }\n            window.location.href = res.url;\n          }\n          return;\n        }\n        \n        const data = await res.json();\n        \n        if (data && data.redirect_link) {\n          if (isMounted.current) {\n            // Set session storage flag to indicate payment attempt\n            if (typeof window !== 'undefined') {\n              sessionStorage.setItem('recent_payment_attempt', 'true');\n            }\n            window.location.href = data.redirect_link;\n          }\n        } else {\n          const msg = (data && typeof data === 'object' && 'message' in data) ? data.message : String(data);\n          throw new Error('No redirect_link received from backend! Error: ' + msg);\n        }\n        return;\n      }\n      // Cash on delivery (existing logic)\n      const orderPayload = {\n        address_id,\n        delivery,\n        payment,\n        order_note: '',\n        cartItems: state.items.map((item) => ({\n          product_id: item.product_id,\n          quantity: item.quantity,\n          variant: item.variant,\n          color: item.color || undefined,\n        })),\n        guest_id: guestId,\n        country: form.country,\n        city: form.city,\n        postal: form.postal,\n        phone: form.phone,\n        name: form.name,\n        address: form.address,\n        email: form.email,\n        shipping_cost: deliveryPrice,\n      };\n      const res = await placeOrder(orderPayload);\n      if (isMounted.current) {\n        setSuccess(\"تم إرسال الطلب بنجاح!\");\n        clearCart();\n        setStep(4);\n      }\n    } catch (err: any) {\n      if (isMounted.current) {\n        if (err && err.message) {\n          setError(err.message);\n        } else {\n          setError(\"حدث خطأ أثناء الشراء\");\n        }\n      }\n    } finally {\n      if (isMounted.current) {\n        setPlacing(false);\n      }\n    }\n  };\n\n  // Stepper UI\n  const StepIndicator = () => (\n    <div className=\"flex justify-center gap-2 mb-8\">\n      {[1, 2].map((s) => (\n        <div\n          key={s}\n          className={`w-8 h-2 rounded-full transition-all duration-300 ${\n            step === s\n              ? \"bg-blue-600 w-16\"\n              : step > s\n              ? \"bg-green-500\"\n              : \"bg-gray-300\"\n          }`}\n        ></div>\n      ))}\n    </div>\n  );\n\n  // Helper to detect dark mode\n  const isDark = typeof window !== 'undefined' && document.documentElement.classList.contains('dark');\n\n  if (guestIdLoading || !guestId) {\n    return <div className=\"text-center text-lg py-10\">جاري تجهيز الحساب المؤقت للزائر...</div>;\n  }\n  if (guestIdError) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-red-100\">\n        <div className=\"text-red-600 text-lg\">{guestIdError}</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`min-h-screen ${isDark ? 'bg-[#181818]' : 'bg-gray-50'}`} dir=\"rtl\">\n      <header className={`${isDark ? 'bg-[#222]' : 'bg-white'} shadow-sm`}>\n        <div className=\"max-w-2xl mx-auto px-4\">\n          <div className={`relative flex items-center py-2 border-b ${isDark ? 'border-[#333]' : 'border-gray-100'} min-h-[48px]`}>\n            {step === 1 ? (\n              <Link href=\"/cart\" aria-label=\"Back to cart\" className={`absolute left-0 top-1/2 -translate-y-1/2 inline-flex items-center justify-center w-9 h-9 rounded-full ${isDark ? 'bg-[#222] hover:bg-[#333]' : 'bg-gray-100 hover:bg-gray-200'} transition-colors shadow-sm focus:outline-none`} style={{ boxShadow: 'none' }}>\n                <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" viewBox=\"0 0 24 24\" style={{ color: WEB_CONSTANTS.secondaryColor }}>\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15 19l-7-7 7-7\" />\n                </svg>\n              </Link>\n            ) : (\n              <button\n                type=\"button\"\n                onClick={() => setStep(1)}\n                aria-label=\"Back to address\"\n                className={`absolute left-0 top-1/2 -translate-y-1/2 inline-flex items-center justify-center w-9 h-9 rounded-full ${isDark ? 'bg-[#222] hover:bg-[#333]' : 'bg-gray-100 hover:bg-gray-200'} transition-colors shadow-sm focus:outline-none`}\n                style={{ boxShadow: 'none' }}\n              >\n                <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" viewBox=\"0 0 24 24\" style={{ color: WEB_CONSTANTS.secondaryColor }}>\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15 19l-7-7 7-7\" />\n                </svg>\n              </button>\n            )}\n            <h1 className=\"mx-auto text-xl font-bold truncate max-w-xs md:max-w-lg text-center w-full\" style={{ color: isDark ? '#fff' : '#222' }}>\n              {step === 2 ? i18n.t('shipping_and_payment') : i18n.t('checkout_address_info')}\n            </h1>\n          </div>\n        </div>\n      </header>\n      <main className=\"max-w-2xl mx-auto px-4 py-8\">\n        <StepIndicator />\n        {step === 1 && (\n          <div className={`${isDark ? 'bg-[#222]' : 'bg-white'} rounded-lg shadow p-6 mb-6`} dir={language === 'ar' ? 'rtl' : 'ltr'}>\n            <h2 className={`text-xl font-semibold mb-4 ${isDark ? 'text-white' : 'text-[#222]'}`}>{i18n.t('checkout_address_info')}</h2>\n            <form className=\"space-y-4\" onSubmit={e => { e.preventDefault(); handleAddressNext(); }}>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div>\n                  <label className={`block mb-1 font-medium ${isDark ? 'text-white' : 'text-[#222]'}`}>{i18n.t('checkout_name')} <span className=\"text-red-500\">*</span></label>\n                  <input name=\"name\" value={form.name} onChange={e => setForm({ ...form, name: e.target.value })} className={`w-full rounded p-2 border focus:outline-none focus:ring-2 ${isDark ? 'bg-[#181818] text-white border-[#444] focus:ring-primary' : 'bg-white text-[#222] border-gray-300 focus:ring-primary'}`} style={{ borderColor: WEB_CONSTANTS.primaryColor }} required />\n                </div>\n                <div>\n                  <label className={`block mb-1 font-medium ${isDark ? 'text-white' : 'text-[#222]'}`}>{i18n.t('checkout_phone')} <span className=\"text-red-500\">*</span></label>\n                  <input\n                    name=\"phone\"\n                    value={form.phone}\n                    onChange={e => {\n                      // Only allow numbers\n                      const value = e.target.value.replace(/[^0-9]/g, '');\n                      setForm({ ...form, phone: value });\n                    }}\n                    className={`w-full rounded p-2 border focus:outline-none focus:ring-2 ${isDark ? 'bg-[#181818] text-white border-[#444] focus:ring-primary' : 'bg-white text-[#222] border-gray-300 focus:ring-primary'}`}\n                    style={{ borderColor: WEB_CONSTANTS.primaryColor }}\n                    required\n                    type=\"tel\"\n                    inputMode=\"numeric\"\n                    pattern=\"[0-9]*\"\n                    autoComplete=\"tel\"\n                  />\n                </div>\n                <div>\n                  <label className={`block mb-1 font-medium ${isDark ? 'text-white' : 'text-[#222]'}`}>{i18n.t('checkout_email')} <span className=\"text-red-500\">*</span></label>\n                  <input\n                    name=\"email\"\n                    value={form.email}\n                    onChange={e => setForm({ ...form, email: e.target.value })}\n                    className={`w-full rounded p-2 border focus:outline-none focus:ring-2 ${isDark ? 'bg-[#181818] text-white border-[#444] focus:ring-primary' : 'bg-white text-[#222] border-gray-300 focus:ring-primary'}`}\n                    style={{ borderColor: WEB_CONSTANTS.primaryColor }}\n                    required\n                    type=\"email\"\n                    autoComplete=\"email\"\n                    pattern=\"^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$\"\n                  />\n                </div>\n                <div>\n                  <label className={`block mb-1 font-medium ${isDark ? 'text-white' : 'text-[#222]'}`}>{i18n.t('checkout_address_type')}</label>\n                  <select name=\"addressType\" value={form.addressType} onChange={e => setForm({ ...form, addressType: e.target.value })} className={`w-full rounded p-2 border focus:outline-none focus:ring-2 ${isDark ? 'bg-[#181818] text-white border-[#444] focus:ring-primary' : 'bg-white text-[#222] border-gray-300 focus:ring-primary'}`} style={{ borderColor: WEB_CONSTANTS.primaryColor }}>\n                    <option value=\"دائم\">{i18n.t('checkout_address_type_permanent')}</option>\n                    <option value=\"مؤقت\">{i18n.t('checkout_address_type_temporary')}</option>\n                  </select>\n                </div>\n                <div className=\"mb-4\">\n                  <label className={`block mb-1 ${isDark ? 'text-white' : 'text-[#222]'}`}>{i18n.t('checkout_country')}</label>\n                  {allowedCountriesLoading ? (\n                    <div className={isDark ? 'text-[#ccc]' : 'text-[#666]'}>جاري تحميل قائمة الدول...</div>\n                  ) : allowedCountries.length === 0 ? (\n                    <div className=\"text-red-500\">{countryError || 'تعذر تحميل قائمة الدول.'}</div>\n                  ) : (\n                    <select\n                      className={`w-full rounded p-2 border focus:outline-none focus:ring-2 ${isDark ? 'bg-[#181818] text-white border-[#444] focus:ring-primary' : 'bg-white text-[#222] border-gray-300 focus:ring-primary'}`}\n                      value={form.country}\n                      onChange={e => setForm({ ...form, country: e.target.value })}\n                      style={{ borderColor: WEB_CONSTANTS.primaryColor }}\n                      required\n                    >\n                      <option value=\"\">{i18n.t('checkout_country')}</option>\n                      {allowedCountries.map(c => (\n                        <option key={c} value={c}>{c}</option>\n                      ))}\n                    </select>\n                  )}\n                  {countryError && allowedCountries.length > 0 && <div className=\"text-red-500 text-sm mt-1\">{countryError}</div>}\n                </div>\n                <div>\n                  <label className={`block mb-1 font-medium ${isDark ? 'text-white' : 'text-[#222]'}`}>{i18n.t('checkout_city')} <span className=\"text-red-500\">*</span></label>\n                  <input name=\"city\" value={form.city} onChange={e => setForm({ ...form, city: e.target.value })} className={`w-full rounded p-2 border focus:outline-none focus:ring-2 ${isDark ? 'bg-[#181818] text-white border-[#444] focus:ring-primary' : 'bg-white text-[#222] border-gray-300 focus:ring-primary'}`} style={{ borderColor: WEB_CONSTANTS.primaryColor }} required />\n                </div>\n                <div>\n                  <label className={`block mb-1 font-medium ${isDark ? 'text-white' : 'text-[#222]'}`}>{i18n.t('checkout_postal')} <span className=\"text-red-500\">*</span></label>\n                  <input\n                    name=\"postal\"\n                    value={form.postal}\n                    onChange={e => {\n                      // Only allow numbers\n                      const value = e.target.value.replace(/[^0-9]/g, '');\n                      setForm({ ...form, postal: value });\n                    }}\n                    className={`w-full rounded p-2 border focus:outline-none focus:ring-2 ${isDark ? 'bg-[#181818] text-white border-[#444] focus:ring-primary' : 'bg-white text-[#222] border-gray-300 focus:ring-primary'}`}\n                    style={{ borderColor: WEB_CONSTANTS.primaryColor }}\n                    required\n                    type=\"text\"\n                    inputMode=\"numeric\"\n                    pattern=\"[0-9]*\"\n                    autoComplete=\"postal-code\"\n                  />\n                </div>\n                <div className=\"md:col-span-2\">\n                  <label className={`block mb-1 font-medium ${isDark ? 'text-white' : 'text-[#222]'}`}>{i18n.t('checkout_address')} <span className=\"text-red-500\">*</span></label>\n                  <input name=\"address\" value={form.address} onChange={e => setForm({ ...form, address: e.target.value })} className={`w-full rounded p-2 border focus:outline-none focus:ring-2 ${isDark ? 'bg-[#181818] text-white border-[#444] focus:ring-primary' : 'bg-white text-[#222] border-gray-300 focus:ring-primary'}`} style={{ borderColor: WEB_CONSTANTS.primaryColor }} required />\n                </div>\n              </div>\n              {error && <div className=\"text-red-600 text-center mt-2 bg-red-50 dark:bg-[#3a1a1a] rounded p-2\">{error}</div>}\n              <button type=\"submit\" className=\"w-full text-white py-3 px-4 rounded-md transition-colors mt-4 font-bold\" style={{ background: WEB_CONSTANTS.primaryColor }} disabled={addressLoading}>\n                {addressLoading ? i18n.t('checkout_saving_address') : i18n.t('checkout_next')}\n              </button>\n            </form>\n          </div>\n        )}\n        {step === 2 && (\n          <form onSubmit={e => { e.preventDefault(); handlePayment(); }} dir={language === 'ar' ? 'rtl' : 'ltr'}>\n            {/* Shipping Options */}\n            <div className={`${isDark ? 'bg-[#222]' : 'bg-white'} rounded-lg shadow p-6 mb-6`}>\n              <h2 className={`text-xl font-semibold mb-4 ${isDark ? 'text-white' : 'text-[#222]'}`}>{i18n.t('shipping_method')}</h2>\n              {shippingLoading ? (\n                <div className={isDark ? 'text-[#ccc]' : 'text-[#666]'}>جاري تحميل خيارات الشحن...</div>\n              ) : shippingOptions.length === 0 ? (\n                <div className=\"text-center text-red-500\">لا توجد خيارات شحن متاحة حالياً لهذا البائع. جرب تحديث الصفحة أو التواصل مع الدعم.</div>\n              ) : (\n                <div className=\"flex flex-col gap-4 mt-2\">\n                  {shippingOptions.map((option: any, idx: number) => (\n                    <label key={option.id || option.key || idx} className={`flex items-center gap-2 cursor-pointer rounded p-3 border transition-colors ${isDark ? 'bg-[#181818] border-[#444] text-white' : 'bg-white border-gray-200 text-[#222]'} ${delivery === (option.key || option.id || option.title) ? `border-[${WEB_CONSTANTS.primaryColor}]` : ''}` }>\n                      <input\n                        type=\"radio\"\n                        name=\"delivery\"\n                        value={option.key || option.id || option.title}\n                        checked={delivery === (option.key || option.id || option.title)}\n                        onChange={async () => {\n                          if (!isMounted.current) return;\n                          setDelivery(option.key || option.id || option.title);\n                          setDeliveryPrice(Number(option.cost || 0));\n                          try {\n                            if (guestId && isMounted.current) {\n                              // Fetch cart and extract cart_group_id\n                              const cart = await getCart();\n                              if (!isMounted.current) return;\n                              if (!Array.isArray(cart) || cart.length === 0) {\n                                if (isMounted.current) {\n                                  setError('السلة فارغة أو لم يتم مزامنتها مع الخادم بعد. يرجى إضافة منتجات وإعادة المحاولة.');\n                                }\n                                return;\n                              }\n                              let cartGroupId = 'default';\n                              if (cart[0].cart_group_id) {\n                                cartGroupId = cart[0].cart_group_id;\n                              }\n                              await chooseShippingMethod(option.id, guestId, cartGroupId);\n                            }\n                          } catch (err) {\n                            if (isMounted.current) {\n                              setError('تعذر حفظ طريقة الشحن المختارة. يرجى المحاولة مرة أخرى.');\n                            }\n                          }\n                        }}\n                        className={`accent-[${WEB_CONSTANTS.primaryColor}] focus:ring-2 focus:ring-[${WEB_CONSTANTS.primaryColor}]`}\n                      />\n                      <span className={isDark ? 'text-white' : 'text-[#222]'}>\n                        {(() => {\n                          const label = i18n.t('fast_delivery', { lng: language });\n                          if (label === 'fast_delivery') {\n                            return language === 'ar' ? 'توصيل سريع' : 'Fast Delivery';\n                          }\n                          return label;\n                        })()}\n                      </span>\n                      <span className=\"ml-2 font-bold\" style={{ color: WEB_CONSTANTS.primaryColor }}>{option.cost !== undefined ? formatPrice(option.cost, config, language) : ''}</span>\n                    </label>\n                  ))}\n                </div>\n              )}\n            </div>\n            {/* Payment Methods */}\n            <div className={`${isDark ? 'bg-[#222]' : 'bg-white'} rounded-lg shadow p-6 mb-6`}>\n              <h2 className={`text-xl font-semibold mb-4 ${isDark ? 'text-white' : 'text-[#222]'}`}>{i18n.t('payment_method')}</h2>\n              {paymentMethodsLoading ? (\n                <div className={isDark ? 'text-[#ccc]' : 'text-[#666]'}>جاري تحميل طرق الدفع...</div>\n              ) : paymentMethodsError ? (\n                <div style={{ color: 'red' }}>{paymentMethodsError}</div>\n              ) : (\n                <div className=\"flex gap-4 mt-2 flex-wrap items-center\">\n                  {paymentMethods.map((method, idx) => (\n                    <label key={method.key || method.name || idx} className={`flex-1 border rounded p-3 cursor-pointer min-w-[120px] flex items-center gap-2 transition-colors ${isDark ? 'bg-[#181818] border-[#444] text-white' : 'bg-white border-gray-200 text-[#222]'} ${payment === (method.key || method.key_name) ? `border-[${WEB_CONSTANTS.primaryColor}]` : ''}` }>\n                      {(method.key || method.key_name)?.toLowerCase() === 'fatoorah' ? (\n                        <>\n                          <input\n                            type=\"radio\"\n                            name=\"payment\"\n                            value={method.key || method.key_name}\n                            checked={payment === (method.key || method.key_name)}\n                            onChange={() => setPayment(method.key || method.key_name)}\n                            className={`ml-2 order-1 accent-[${WEB_CONSTANTS.primaryColor}] focus:ring-2 focus:ring-[${WEB_CONSTANTS.primaryColor}]`}\n                            disabled={paymentMethodsLoading}\n                          />\n                          <div className=\"flex-1 flex justify-center order-2\">\n                            <img src=\"/payment-logos.png\" alt=\"Fatoorah Payment Methods\" className=\"h-10 max-w-[180px] object-contain\" />\n                          </div>\n                        </>\n                      ) : (\n                        <>\n                          <input\n                            type=\"radio\"\n                            name=\"payment\"\n                            value={method.key || method.key_name}\n                            checked={payment === (method.key || method.key_name)}\n                            onChange={() => setPayment(method.key || method.key_name)}\n                            className={`accent-[${WEB_CONSTANTS.primaryColor}] focus:ring-2 focus:ring-[${WEB_CONSTANTS.primaryColor}]`}\n                            disabled={paymentMethodsLoading}\n                          />\n                          {method.image && <img src={method.image} alt={method.name || method.label || 'طريقة الدفع'} className=\"h-5 inline\" />}\n                          <span className={isDark ? 'text-white' : 'text-[#222]'}>{method.name || method.label || method.key || method.key_name}</span>\n                        </>\n                      )}\n                    </label>\n                  ))}\n                </div>\n              )}\n            </div>\n            {/* Order Summary */}\n            <div className={`${isDark ? 'bg-[#222]' : 'bg-white'} rounded-lg shadow p-6 mb-6`}>\n              <h2 className={`text-lg font-semibold mb-4 ${isDark ? 'text-white' : 'text-[#222]'}`}>{i18n.t('order_summary')}</h2>\n              {state.items.length === 0 ? (\n                <div className={isDark ? 'text-[#ccc]' : 'text-[#666]'}>السلة فارغة</div>\n              ) : (\n                <ul className={`divide-y ${isDark ? 'divide-[#333]' : 'divide-gray-200'} mb-4`}>\n                  {state.items.map((item) => (\n                    <li key={item.id} className=\"py-2 flex justify-between items-center\">\n                      <span className={`text-sm ${isDark ? 'text-white' : 'text-[#222]'}`}>{getLocalizedProductName(item, language)} × {item.quantity}</span>\n                      <span className={`text-sm font-medium ${isDark ? 'text-white' : 'text-[#222]'}`}>{formatPrice((item.price - item.discount) * item.quantity, config, language)}</span>\n                    </li>\n                  ))}\n                </ul>\n              )}\n              <div className={`flex justify-between text-sm mb-1 ${isDark ? 'text-[#ccc]' : 'text-[#666]'}`}> \n                <span>{i18n.t('checkout_subtotal')}</span>\n                <span>{formatPrice(state.subtotal, config, language)}</span>\n              </div>\n              <div className={`flex justify-between text-sm mb-1 ${isDark ? 'text-[#ccc]' : 'text-[#666]'}`}> \n                <span>{i18n.t('checkout_shipping')}</span>\n                <span>{formatPrice(deliveryPrice, config, language)}</span>\n              </div>\n              <div className={`border-t pt-3 flex justify-between text-lg font-semibold ${isDark ? 'border-[#333] text-white' : 'border-gray-200 text-[#222]'}`}> \n                <span>{i18n.t('checkout_total')}</span>\n                <span>{formatPrice(state.subtotal + deliveryPrice, config, language)}</span>\n              </div>\n            </div>\n            {error && <div className=\"text-red-600 text-center mt-4 text-lg font-bold\">[خطأ]: {error}</div>}\n            <button\n              type=\"submit\"\n              className=\"w-full text-white py-3 px-4 rounded-md transition-colors text-lg font-bold mt-4\"\n              style={{ background: WEB_CONSTANTS.primaryColor }}\n              disabled={placing || !payment || paymentMethodsLoading || shippingLoading || !delivery}\n            >\n              {placing ? (\n                <span className=\"flex items-center justify-center\">\n                  <svg className=\"animate-spin h-6 w-6 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                    <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                    <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z\"></path>\n                  </svg>\n                </span>\n              ) : payment !== 'cod' ? 'ادفع الآن' : 'تأكيد الطلب'}\n            </button>\n          </form>\n        )}\n        {step === 4 && (\n          <div className={`${isDark ? 'bg-[#222]' : 'bg-white'} rounded-lg shadow p-6 mb-6 text-center`}>\n            <h2 className=\"text-2xl font-bold text-green-600 mb-4\">تم إرسال الطلب بنجاح!</h2>\n            <p className=\"mb-6\">شكراً لطلبك. سيتم التواصل معك قريباً.</p>\n            <Link href=\"/\" className=\"text-white py-2 px-6 rounded\" style={{ background: WEB_CONSTANTS.primaryColor }}>{i18n.t('checkout_return_home')}</Link>\n          </div>\n        )}\n      </main>\n      <div className=\"h-20 lg:hidden\" />\n    </div>\n  );\n} "],"names":[],"mappings":"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","debugId":null}}]
}